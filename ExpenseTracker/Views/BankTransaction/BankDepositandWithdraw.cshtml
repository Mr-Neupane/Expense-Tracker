@model ExpenseTracker.ViewModels.BankTransactionVm;


@{
    ViewData["Title"] = "Bank Transaction";
}

<form asp-action="BankDepositandWithdraw" method="post" class="container mt-4" style="max-width:500px;margin:auto;">

    <div class="card">
        <div class="card-header">
            <h6>Bank Account Information</h6>
        </div>
        <div class="card-body">

            <div class="mb-3">
                <label asp-for="BankId"></label>
                <select asp-for="BankId" id="BankName" class="form-control" required="required">
                    <option value="">Select a Bank</option>
                </select>
                <span asp-validation-for="BankId" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="TxnDate"></label>
                <input asp-for="TxnDate" class="form-control" type="date" id="TxnDate"/>
                <span asp-validation-for="TxnDate" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Type"></label>
                <select asp-for="Type" class="form-control" required="required">
                    <option value="">Select Transaction Type</option>
                    <option value="Deposit">Deposit</option>
                    <option value="Withdraw">Withdraw</option>
                </select>
                <span asp-validation-for="Type" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Amount"></label>
                <input asp-for="Amount" class="form-control" type="number" step="0.01" placeholder=""
                       required="required"/>
                <span asp-validation-for="Amount" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Remarks"></label>
                <textarea asp-for="Remarks" class="form-control" placeholder="Enter remarks"></textarea>
                <span asp-validation-for="Remarks" class="text-danger"></span>
            </div>

            <button type="submit" class="btn btn-primary">Record Transaction</button>
        </div>
    </div>
</form>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
@section Scripts {
    <script>
       
        document.addEventListener('DOMContentLoaded', function () {
            var today = new Date();
            var yyyy = today.getFullYear();
            var mm = today.getMonth() + 1;
            var dd = today.getDate();

            if (mm < 10) mm = '0' + mm; 
            if (dd < 10) dd = '0' + dd; 

            var formattedDate = yyyy + '-' + mm + '-' + dd;
            document.getElementById('TxnDate').value = formattedDate;
        });
    </script>
    
    <script>
        $(document).ready(function () {
            $.ajax({
                url: '@Url.Action("GetBanks", "BankTransaction")', 
                type: 'GET',
                success: function (data) {
                    $('#BankName').empty();
                    $('#BankName').append('<option value="">Select a Bank</option>');
                    $.each(data, function (index, bank) {
                        $('#BankName').append('<option value="' + bank.id + '">' + bank.bankname + '</option>');
                    });
                },
                error: function () {
                    alert("Error loading bank data.");
                }
            });
        });
    </script>
}

@if (TempData["AlertMessage"] != null)
{
    <script>
        alert("@TempData["AlertMessage"]");
    </script>
}
@if (TempData["SuccessMessage"] != null)
{
    <script>
        alert("@TempData["SuccessMessage"]");
    </script>
}


